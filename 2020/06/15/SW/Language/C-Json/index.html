

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/world.png">
  <link rel="icon" href="/img/world.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#3e424a">
  <meta name="author" content="Jianliang·Shen">
  <meta name="keywords" content="">
  
    <meta name="description" content="使用C语言在程序读入配置文件时，一种常用的方式就是使用JSON格式，对于C语言而言，处理JSON格式的数据稍显麻烦，本文将介绍简单一层格式的读入方式以及二层格式的读入方式，更复杂的写入配置文件不细述。">
<meta property="og:type" content="article">
<meta property="og:title" content="C语言读入cjson配置文件">
<meta property="og:url" content="http://yoursite.com/2020/06/15/SW/Language/C-Json/index.html">
<meta property="og:site_name" content="TechOdyssey">
<meta property="og:description" content="使用C语言在程序读入配置文件时，一种常用的方式就是使用JSON格式，对于C语言而言，处理JSON格式的数据稍显麻烦，本文将介绍简单一层格式的读入方式以及二层格式的读入方式，更复杂的写入配置文件不细述。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-06-15T21:34:44.000Z">
<meta property="article:modified_time" content="2024-07-30T16:39:00.415Z">
<meta property="article:author" content="Jianliang·Shen">
<meta property="article:tag" content="C&#x2F;C++">
<meta property="article:tag" content="Data Structure">
<meta name="twitter:card" content="summary_large_image">
  
  
  
  <title>C语言读入cjson配置文件 - TechOdyssey</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/icon.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"yoursite.com","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":15,"cursorChar":"|","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":"❡"},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Tech Odyssey</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/" target="_self">
                <i class="iconfont icon-link-fill"></i>
                <span>Links</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-bookmark-fill"></i>
                <span>Favor</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="https://vercel.com/jianliang-shens-projects" target="_self">
                    <i class="iconfont icon-vercel"></i>
                    <span>Vercel</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/pdf/" target="_self">
                    <i class="iconfont icon-pdf-new"></i>
                    <span>PDF</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://www.google.com/" target="_self">
                    <i class="iconfont icon-google-new"></i>
                    <span>Google</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://www.baidu.com/" target="_self">
                    <i class="iconfont icon-baidu-new"></i>
                    <span>Baidu</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://github.com/Jianliang-Shen" target="_self">
                    <i class="iconfont icon-github-new"></i>
                    <span>Github</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://www.zhihu.com" target="_self">
                    <i class="iconfont icon-zhihu-new"></i>
                    <span>Zhihu</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://www.bilibili.com/" target="_self">
                    <i class="iconfont icon-bilibili-new"></i>
                    <span>Bilibili</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://chat.openai.com/" target="_self">
                    <i class="iconfont icon-chatGPT"></i>
                    <span>Chatgpt</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://msdn.itellyou.cn/" target="_self">
                    <i class="iconfont icon-microsoft"></i>
                    <span>MSDN</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="https://www.iconfont.cn/" target="_self">
                    <i class="iconfont icon-iconfont"></i>
                    <span>Ali Icon</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/back_1.jpg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.1)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="C语言读入cjson配置文件"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2020-06-15 21:34" pubdate>
          2020年6月15日 晚上
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          6.4k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          54 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">C语言读入cjson配置文件</h1>
            
            
              <div class="markdown-body">
                
                <p>使用C语言在程序读入配置文件时，一种常用的方式就是使用JSON格式，对于C语言而言，处理JSON格式的数据稍显麻烦，本文将介绍简单一层格式的读入方式以及二层格式的读入方式，更复杂的写入配置文件不细述。</p>
<span id="more"></span>

<ul>
<li><a href="#cjson%E6%8E%A5%E5%8F%A3%E5%87%BD%E6%95%B0">CJSON接口函数</a><ul>
<li><a href="#%E5%BA%93%E5%87%BD%E6%95%B0%E4%BB%A3%E7%A0%81">库函数代码</a></li>
<li><a href="#%E6%8E%A5%E5%8F%A3%E5%87%BD%E6%95%B0">接口函数</a></li>
</ul>
</li>
<li><a href="#%E8%AF%BB%E4%B8%80%E5%B1%82%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">读一层配置文件</a></li>
<li><a href="#%E8%AF%BB%E4%B8%A4%E5%B1%82%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">读两层配置文件</a></li>
<li><a href="#%E5%86%99%E5%85%A5%E4%B8%A4%E5%B1%82%E6%96%87%E4%BB%B6">写入两层文件</a></li>
</ul>
<h2 id="CJSON接口函数"><a href="#CJSON接口函数" class="headerlink" title="CJSON接口函数"></a>CJSON接口函数</h2><h3 id="库函数代码"><a href="#库函数代码" class="headerlink" title="库函数代码"></a>库函数代码</h3><p>使用下面两个文件添加到项目中，编译时增加-lm条件，引用math库：</p>
<details>
<summary>cJSON.h</summary>  
  
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">  Copyright (c) 2009 Dave Gamble</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">  Permission is hereby granted, free of charge, to any person obtaining a copy</span><br><span class="hljs-comment">  of this software and associated documentation files (the &quot;Software&quot;), to deal</span><br><span class="hljs-comment">  in the Software without restriction, including without limitation the rights</span><br><span class="hljs-comment">  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><br><span class="hljs-comment">  copies of the Software, and to permit persons to whom the Software is</span><br><span class="hljs-comment">  furnished to do so, subject to the following conditions:</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">  The above copyright notice and this permission notice shall be included in</span><br><span class="hljs-comment">  all copies or substantial portions of the Software.</span><br><span class="hljs-comment"> </span><br><span class="hljs-comment">  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br><span class="hljs-comment">  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><br><span class="hljs-comment">  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><br><span class="hljs-comment">  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><br><span class="hljs-comment">  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><br><span class="hljs-comment">  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span><br><span class="hljs-comment">  THE SOFTWARE.</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> cJSON__h</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON__h</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __cplusplus</span><br><span class="hljs-keyword">extern</span> <span class="hljs-string">&quot;C&quot;</span><br>&#123;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;float.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;limits.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctype.h&gt;</span></span><br><br><span class="hljs-comment">/* cJSON Types: */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_False 0</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_True 1</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_NULL 2</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_Number 3</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_String 4</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_Array 5</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_Object 6</span><br>	<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_IsReference 256</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_StringIsConst 512</span><br><br><span class="hljs-comment">/* The cJSON structure: */</span><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> &#123;<br>	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> *next,*prev;	<span class="hljs-comment">/* next/prev allow you to walk array/object chains. Alternatively, use GetArraySize/GetArrayItem/GetObjectItem */</span><br>	<span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> *child;		<span class="hljs-comment">/* An array or object item will have a child pointer pointing to a chain of the items in the array/object. */</span><br><br>	<span class="hljs-type">int</span> type;					<span class="hljs-comment">/* The type of the item, as above. */</span><br><br>	<span class="hljs-type">char</span> *valuestring;			<span class="hljs-comment">/* The item&#x27;s string, if type==cJSON_String */</span><br>	<span class="hljs-type">int</span> valueint;				<span class="hljs-comment">/* The item&#x27;s number, if type==cJSON_Number */</span><br>	<span class="hljs-type">double</span> valuedouble;			<span class="hljs-comment">/* The item&#x27;s number, if type==cJSON_Number */</span><br><br>	<span class="hljs-type">char</span> *string;				<span class="hljs-comment">/* The item&#x27;s name string, if this item is the child of, or is in the list of subitems of an object. */</span><br>&#125; cJSON;<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON_Hooks</span> &#123;<br>      <span class="hljs-type">void</span> *(*malloc_fn)(<span class="hljs-type">size_t</span> sz);<br>      <span class="hljs-built_in">void</span> (*free_fn)(<span class="hljs-type">void</span> *ptr);<br>&#125; cJSON_Hooks;<br><br><span class="hljs-comment">/* Supply malloc, realloc and free functions to cJSON */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_InitHooks</span><span class="hljs-params">(cJSON_Hooks* hooks)</span></span>;<br><br><br><span class="hljs-comment">/* Supply a block of JSON, and this returns a cJSON object you can interrogate. Call cJSON_Delete when finished. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_Parse</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span>;<br><span class="hljs-comment">/* Render a cJSON entity to text for transfer/storage. Free the char* when finished. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">char</span>  *<span class="hljs-title">cJSON_Print</span><span class="hljs-params">(cJSON *item)</span></span>;<br><span class="hljs-comment">/* Render a cJSON entity to text for transfer/storage without any formatting. Free the char* when finished. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">char</span>  *<span class="hljs-title">cJSON_PrintUnformatted</span><span class="hljs-params">(cJSON *item)</span></span>;<br><span class="hljs-comment">/* Render a cJSON entity to text using a buffered strategy. prebuffer is a guess at the final size. guessing well reduces reallocation. fmt=0 gives unformatted, =1 gives formatted */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">char</span> *<span class="hljs-title">cJSON_PrintBuffered</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> prebuffer,<span class="hljs-type">int</span> fmt)</span></span>;<br><span class="hljs-comment">/* Delete a cJSON entity and all subentities. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>   <span class="hljs-title">cJSON_Delete</span><span class="hljs-params">(cJSON *c)</span></span>;<br><br><span class="hljs-comment">/* Returns the number of items in an array (or object). */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">int</span>	  <span class="hljs-title">cJSON_GetArraySize</span><span class="hljs-params">(cJSON *array)</span></span>;<br><span class="hljs-comment">/* Retrieve item number &quot;item&quot; from array &quot;array&quot;. Returns NULL if unsuccessful. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_GetArrayItem</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> item)</span></span>;<br><span class="hljs-comment">/* Get item &quot;string&quot; from object. Case insensitive. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_GetObjectItem</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span></span>;<br><br><span class="hljs-comment">/* For analysing failed parses. This returns a pointer to the parse error. You&#x27;ll probably need to look a few chars back to make sense of it. Defined when cJSON_Parse() returns 0. 0 when cJSON_Parse() succeeds. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">cJSON_GetErrorPtr</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br>	<br><span class="hljs-comment">/* These calls create a cJSON item of the appropriate type. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateNull</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateTrue</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateFalse</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateBool</span><span class="hljs-params">(<span class="hljs-type">int</span> b)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateNumber</span><span class="hljs-params">(<span class="hljs-type">double</span> num)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateString</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateArray</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateObject</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span>;<br><br><span class="hljs-comment">/* These utilities create an Array of count items. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateIntArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> *numbers,<span class="hljs-type">int</span> count)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateFloatArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">float</span> *numbers,<span class="hljs-type">int</span> count)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateDoubleArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">double</span> *numbers,<span class="hljs-type">int</span> count)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_CreateStringArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **strings,<span class="hljs-type">int</span> count)</span></span>;<br><br><span class="hljs-comment">/* Append item to the specified array/object. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_AddItemToArray</span><span class="hljs-params">(cJSON *array, cJSON *item)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>	<span class="hljs-title">cJSON_AddItemToObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>	<span class="hljs-title">cJSON_AddItemToObjectCS</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span></span>;	<span class="hljs-comment">/* Use this when string is definitely const (i.e. a literal, or as good as), and will definitely survive the cJSON object */</span><br><span class="hljs-comment">/* Append reference to item to the specified array/object. Use this when you want to add an existing cJSON to a new cJSON, but don&#x27;t want to corrupt your existing cJSON. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_AddItemReferenceToArray</span><span class="hljs-params">(cJSON *array, cJSON *item)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>	<span class="hljs-title">cJSON_AddItemReferenceToObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span></span>;<br><br><span class="hljs-comment">/* Remove/Detatch items from Arrays/Objects. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_DetachItemFromArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>   <span class="hljs-title">cJSON_DeleteItemFromArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_DetachItemFromObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span>   <span class="hljs-title">cJSON_DeleteItemFromObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span></span>;<br>	<br><span class="hljs-comment">/* Update array items. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_InsertItemInArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which,cJSON *newitem)</span></span>;	<span class="hljs-comment">/* Shifts pre-existing items to the right. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_ReplaceItemInArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which,cJSON *newitem)</span></span>;<br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_ReplaceItemInObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *newitem)</span></span>;<br><br><span class="hljs-comment">/* Duplicate a cJSON item */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_Duplicate</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> recurse)</span></span>;<br><span class="hljs-comment">/* Duplicate will create a new, identical cJSON item to the one you pass, in new memory that will</span><br><span class="hljs-comment">need to be released. With recurse!=0, it will duplicate any children connected to the item.</span><br><span class="hljs-comment">The item-&gt;next and -&gt;prev pointers are always zero on return from Duplicate. */</span><br><br><span class="hljs-comment">/* ParseWithOpts allows you to require (and check) that the JSON is null terminated, and to retrieve the pointer to the final byte parsed. */</span><br><span class="hljs-function"><span class="hljs-keyword">extern</span> cJSON *<span class="hljs-title">cJSON_ParseWithOpts</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value,<span class="hljs-type">const</span> <span class="hljs-type">char</span> **return_parse_end,<span class="hljs-type">int</span> require_null_terminated)</span></span>;<br><br><span class="hljs-function"><span class="hljs-keyword">extern</span> <span class="hljs-type">void</span> <span class="hljs-title">cJSON_Minify</span><span class="hljs-params">(<span class="hljs-type">char</span> *json)</span></span>;<br><br><span class="hljs-comment">/* Macros for creating things quickly. */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddNullToObject(object,name)		cJSON_AddItemToObject(object, name, cJSON_CreateNull())</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddTrueToObject(object,name)		cJSON_AddItemToObject(object, name, cJSON_CreateTrue())</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddFalseToObject(object,name)		cJSON_AddItemToObject(object, name, cJSON_CreateFalse())</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddBoolToObject(object,name,b)	cJSON_AddItemToObject(object, name, cJSON_CreateBool(b))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddNumberToObject(object,name,n)	cJSON_AddItemToObject(object, name, cJSON_CreateNumber(n))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_AddStringToObject(object,name,s)	cJSON_AddItemToObject(object, name, cJSON_CreateString(s))</span><br><br><span class="hljs-comment">/* When assigning an integer value, it needs to be propagated to valuedouble too. */</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_SetIntValue(object,val)			((object)?(object)-&gt;valueint=(object)-&gt;valuedouble=(val):(val))</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> cJSON_SetNumberValue(object,val)		((object)?(object)-&gt;valueint=(object)-&gt;valuedouble=(val):(val))</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> __cplusplus</span><br>&#125;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><br></code></pre></td></tr></table></figure>
</details>  
  
<details>
<summary>cJSON.c</summary>  
  
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-comment">/*</span><br><span class="hljs-comment">  Copyright (c) 2009 Dave Gamble</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  Permission is hereby granted, free of charge, to any person obtaining a copy</span><br><span class="hljs-comment">  of this software and associated documentation files (the &quot;Software&quot;), to deal</span><br><span class="hljs-comment">  in the Software without restriction, including without limitation the rights</span><br><span class="hljs-comment">  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><br><span class="hljs-comment">  copies of the Software, and to permit persons to whom the Software is</span><br><span class="hljs-comment">  furnished to do so, subject to the following conditions:</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  The above copyright notice and this permission notice shall be included in</span><br><span class="hljs-comment">  all copies or substantial portions of the Software.</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">  THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><br><span class="hljs-comment">  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><br><span class="hljs-comment">  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><br><span class="hljs-comment">  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><br><span class="hljs-comment">  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><br><span class="hljs-comment">  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span><br><span class="hljs-comment">  THE SOFTWARE.</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-comment">/* cJSON */</span><br><span class="hljs-comment">/* JSON parser in C. */</span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;math.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;float.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;limits.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;ctype.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;cJSON.h&quot;</span></span><br><br><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *ep;<br><br><span class="hljs-function"><span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">cJSON_GetErrorPtr</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span> </span>&#123;<span class="hljs-keyword">return</span> ep;&#125;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">cJSON_strcasecmp</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *s1,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *s2)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">if</span> (!s1) <span class="hljs-keyword">return</span> (s1==s2)?<span class="hljs-number">0</span>:<span class="hljs-number">1</span>;<span class="hljs-keyword">if</span> (!s2) <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">for</span>(; <span class="hljs-built_in">tolower</span>(*s1) == <span class="hljs-built_in">tolower</span>(*s2); ++s1, ++s2)	<span class="hljs-keyword">if</span>(*s1 == <span class="hljs-number">0</span>)	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">tolower</span>(*(<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)s1) - <span class="hljs-built_in">tolower</span>(*(<span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)s2);<br>&#125;<br><br><span class="hljs-type">static</span> <span class="hljs-type">void</span> *(*cJSON_malloc)(<span class="hljs-type">size_t</span> sz) = malloc;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-title">void</span> <span class="hljs-params">(*cJSON_free)</span><span class="hljs-params">(<span class="hljs-type">void</span> *ptr)</span> </span>= free;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span>* <span class="hljs-title">cJSON_strdup</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span>* str)</span></span><br><span class="hljs-function"></span>&#123;<br>      <span class="hljs-type">size_t</span> len;<br>      <span class="hljs-type">char</span>* copy;<br><br>      len = <span class="hljs-built_in">strlen</span>(str) + <span class="hljs-number">1</span>;<br>      <span class="hljs-keyword">if</span> (!(copy = (<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len))) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>      <span class="hljs-built_in">memcpy</span>(copy,str,len);<br>      <span class="hljs-keyword">return</span> copy;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cJSON_InitHooks</span><span class="hljs-params">(cJSON_Hooks* hooks)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!hooks) &#123; <span class="hljs-comment">/* Reset hooks */</span><br>        cJSON_malloc = malloc;<br>        cJSON_free = free;<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>	cJSON_malloc = (hooks-&gt;malloc_fn)?hooks-&gt;malloc_fn:malloc;<br>	cJSON_free	 = (hooks-&gt;free_fn)?hooks-&gt;free_fn:free;<br>&#125;<br><br><span class="hljs-comment">/* Internal constructor. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> cJSON *<span class="hljs-title">cJSON_New_Item</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br>	cJSON* node = (cJSON*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-built_in">sizeof</span>(cJSON));<br>	<span class="hljs-keyword">if</span> (node) <span class="hljs-built_in">memset</span>(node,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(cJSON));<br>	<span class="hljs-keyword">return</span> node;<br>&#125;<br><br><span class="hljs-comment">/* Delete a cJSON structure. */</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cJSON_Delete</span><span class="hljs-params">(cJSON *c)</span></span><br><span class="hljs-function"></span>&#123;<br>	cJSON *next;<br>	<span class="hljs-keyword">while</span> (c)<br>	&#123;<br>		next=c-&gt;next;<br>		<span class="hljs-keyword">if</span> (!(c-&gt;type&amp;cJSON_IsReference) &amp;&amp; c-&gt;child) <span class="hljs-built_in">cJSON_Delete</span>(c-&gt;child);<br>		<span class="hljs-keyword">if</span> (!(c-&gt;type&amp;cJSON_IsReference) &amp;&amp; c-&gt;valuestring) <span class="hljs-built_in">cJSON_free</span>(c-&gt;valuestring);<br>		<span class="hljs-keyword">if</span> (!(c-&gt;type&amp;cJSON_StringIsConst) &amp;&amp; c-&gt;string) <span class="hljs-built_in">cJSON_free</span>(c-&gt;string);<br>		<span class="hljs-built_in">cJSON_free</span>(c);<br>		c=next;<br>	&#125;<br>&#125;<br><br><span class="hljs-comment">/* Parse the input text to generate a number, and populate the result into item. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_number</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *num)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">double</span> n=<span class="hljs-number">0</span>,sign=<span class="hljs-number">1</span>,scale=<span class="hljs-number">0</span>;<span class="hljs-type">int</span> subscale=<span class="hljs-number">0</span>,signsubscale=<span class="hljs-number">1</span>;<br><br>	<span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;-&#x27;</span>) sign=<span class="hljs-number">-1</span>,num++;	<span class="hljs-comment">/* Has sign? */</span><br>	<span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;0&#x27;</span>) num++;			<span class="hljs-comment">/* is zero */</span><br>	<span class="hljs-keyword">if</span> (*num&gt;=<span class="hljs-string">&#x27;1&#x27;</span> &amp;&amp; *num&lt;=<span class="hljs-string">&#x27;9&#x27;</span>)	<span class="hljs-keyword">do</span>	n=(n*<span class="hljs-number">10.0</span>)+(*num++ -<span class="hljs-string">&#x27;0&#x27;</span>);	<span class="hljs-keyword">while</span> (*num&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *num&lt;=<span class="hljs-string">&#x27;9&#x27;</span>);	<span class="hljs-comment">/* Number? */</span><br>	<span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;.&#x27;</span> &amp;&amp; num[<span class="hljs-number">1</span>]&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; num[<span class="hljs-number">1</span>]&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) &#123;num++;		<span class="hljs-keyword">do</span>	n=(n*<span class="hljs-number">10.0</span>)+(*num++ -<span class="hljs-string">&#x27;0&#x27;</span>),scale--; <span class="hljs-keyword">while</span> (*num&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *num&lt;=<span class="hljs-string">&#x27;9&#x27;</span>);&#125;	<span class="hljs-comment">/* Fractional part? */</span><br>	<span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;e&#x27;</span> || *num==<span class="hljs-string">&#x27;E&#x27;</span>)		<span class="hljs-comment">/* Exponent? */</span><br>	&#123;	num++;<span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;+&#x27;</span>) num++;	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*num==<span class="hljs-string">&#x27;-&#x27;</span>) signsubscale=<span class="hljs-number">-1</span>,num++;		<span class="hljs-comment">/* With sign? */</span><br>		<span class="hljs-keyword">while</span> (*num&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *num&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) subscale=(subscale*<span class="hljs-number">10</span>)+(*num++ - <span class="hljs-string">&#x27;0&#x27;</span>);	<span class="hljs-comment">/* Number? */</span><br>	&#125;<br><br>	n=sign*n*<span class="hljs-built_in">pow</span>(<span class="hljs-number">10.0</span>,(scale+subscale*signsubscale));	<span class="hljs-comment">/* number = +/- number.fraction * 10^+/- exponent */</span><br>	<br>	item-&gt;valuedouble=n;<br>	item-&gt;valueint=(<span class="hljs-type">int</span>)n;<br>	item-&gt;type=cJSON_Number;<br>	<span class="hljs-keyword">return</span> num;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">pow2gt</span> <span class="hljs-params">(<span class="hljs-type">int</span> x)</span>	</span>&#123;	--x;	x|=x&gt;&gt;<span class="hljs-number">1</span>;	x|=x&gt;&gt;<span class="hljs-number">2</span>;	x|=x&gt;&gt;<span class="hljs-number">4</span>;	x|=x&gt;&gt;<span class="hljs-number">8</span>;	x|=x&gt;&gt;<span class="hljs-number">16</span>;	<span class="hljs-keyword">return</span> x<span class="hljs-number">+1</span>;	&#125;<br><br><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> &#123;<span class="hljs-type">char</span> *buffer; <span class="hljs-type">int</span> length; <span class="hljs-type">int</span> offset; &#125; printbuffer;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span>* <span class="hljs-title">ensure</span><span class="hljs-params">(printbuffer *p,<span class="hljs-type">int</span> needed)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> *newbuffer;<span class="hljs-type">int</span> newsize;<br>	<span class="hljs-keyword">if</span> (!p || !p-&gt;buffer) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	needed+=p-&gt;offset;<br>	<span class="hljs-keyword">if</span> (needed&lt;=p-&gt;length) <span class="hljs-keyword">return</span> p-&gt;buffer+p-&gt;offset;<br><br>	newsize=<span class="hljs-built_in">pow2gt</span>(needed);<br>	newbuffer=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(newsize);<br>	<span class="hljs-keyword">if</span> (!newbuffer) &#123;<span class="hljs-built_in">cJSON_free</span>(p-&gt;buffer);p-&gt;length=<span class="hljs-number">0</span>,p-&gt;buffer=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<br>	<span class="hljs-keyword">if</span> (newbuffer) <span class="hljs-built_in">memcpy</span>(newbuffer,p-&gt;buffer,p-&gt;length);<br>	<span class="hljs-built_in">cJSON_free</span>(p-&gt;buffer);<br>	p-&gt;length=newsize;<br>	p-&gt;buffer=newbuffer;<br>	<span class="hljs-keyword">return</span> newbuffer+p-&gt;offset;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">int</span> <span class="hljs-title">update</span><span class="hljs-params">(printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> *str;<br>	<span class="hljs-keyword">if</span> (!p || !p-&gt;buffer) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	str=p-&gt;buffer+p-&gt;offset;<br>	<span class="hljs-keyword">return</span> p-&gt;offset+<span class="hljs-built_in">strlen</span>(str);<br>&#125;<br><br><span class="hljs-comment">/* Render the number nicely from the given item into a string. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_number</span><span class="hljs-params">(cJSON *item,printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> *str=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">double</span> d=item-&gt;valuedouble;<br>	<span class="hljs-keyword">if</span> (d==<span class="hljs-number">0</span>)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (p)	str=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">2</span>);<br>		<span class="hljs-keyword">else</span>	str=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-number">2</span>);	<span class="hljs-comment">/* special case for 0. */</span><br>		<span class="hljs-keyword">if</span> (str) <span class="hljs-built_in">strcpy</span>(str,<span class="hljs-string">&quot;0&quot;</span>);<br>	&#125;<br>	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(((<span class="hljs-type">double</span>)item-&gt;valueint)-d)&lt;=DBL_EPSILON &amp;&amp; d&lt;=INT_MAX &amp;&amp; d&gt;=INT_MIN)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (p)	str=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">21</span>);<br>		<span class="hljs-keyword">else</span>	str=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-number">21</span>);	<span class="hljs-comment">/* 2^64+1 can be represented in 21 chars. */</span><br>		<span class="hljs-keyword">if</span> (str)	<span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">&quot;%d&quot;</span>,item-&gt;valueint);<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-keyword">if</span> (p)	str=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">64</span>);<br>		<span class="hljs-keyword">else</span>	str=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-number">64</span>);	<span class="hljs-comment">/* This is a nice tradeoff. */</span><br>		<span class="hljs-keyword">if</span> (str)<br>		&#123;<br>			<span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(<span class="hljs-built_in">floor</span>(d)-d)&lt;=DBL_EPSILON &amp;&amp; <span class="hljs-built_in">fabs</span>(d)&lt;<span class="hljs-number">1.0e60</span>)<span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">&quot;%.0f&quot;</span>,d);<br>			<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">fabs</span>(d)&lt;<span class="hljs-number">1.0e-6</span> || <span class="hljs-built_in">fabs</span>(d)&gt;<span class="hljs-number">1.0e9</span>)			<span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">&quot;%e&quot;</span>,d);<br>			<span class="hljs-keyword">else</span>												<span class="hljs-built_in">sprintf</span>(str,<span class="hljs-string">&quot;%f&quot;</span>,d);<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> str;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">unsigned</span> <span class="hljs-title">parse_hex4</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">unsigned</span> h=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) h+=(*str)-<span class="hljs-string">&#x27;0&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;F&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;A&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;f&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;a&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	h=h&lt;&lt;<span class="hljs-number">4</span>;str++;<br>	<span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) h+=(*str)-<span class="hljs-string">&#x27;0&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;F&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;A&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;f&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;a&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	h=h&lt;&lt;<span class="hljs-number">4</span>;str++;<br>	<span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) h+=(*str)-<span class="hljs-string">&#x27;0&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;F&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;A&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;f&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;a&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	h=h&lt;&lt;<span class="hljs-number">4</span>;str++;<br>	<span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;9&#x27;</span>) h+=(*str)-<span class="hljs-string">&#x27;0&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;A&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;F&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;A&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*str&gt;=<span class="hljs-string">&#x27;a&#x27;</span> &amp;&amp; *str&lt;=<span class="hljs-string">&#x27;f&#x27;</span>) h+=<span class="hljs-number">10</span>+(*str)-<span class="hljs-string">&#x27;a&#x27;</span>; <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">return</span> h;<br>&#125;<br><br><span class="hljs-comment">/* Parse the input text into an unescaped cstring, and populate item. */</span><br><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> firstByteMark[<span class="hljs-number">7</span>] = &#123; <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xC0</span>, <span class="hljs-number">0xE0</span>, <span class="hljs-number">0xF0</span>, <span class="hljs-number">0xF8</span>, <span class="hljs-number">0xFC</span> &#125;;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_string</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">const</span> <span class="hljs-type">char</span> *ptr=str<span class="hljs-number">+1</span>;<span class="hljs-type">char</span> *ptr2;<span class="hljs-type">char</span> *out;<span class="hljs-type">int</span> len=<span class="hljs-number">0</span>;<span class="hljs-type">unsigned</span> uc,uc2;<br>	<span class="hljs-keyword">if</span> (*str!=<span class="hljs-string">&#x27;\&quot;&#x27;</span>) &#123;ep=str;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* not a string! */</span><br>	<br>	<span class="hljs-keyword">while</span> (*ptr!=<span class="hljs-string">&#x27;\&quot;&#x27;</span> &amp;&amp; *ptr &amp;&amp; ++len) <span class="hljs-keyword">if</span> (*ptr++ == <span class="hljs-string">&#x27;\\&#x27;</span>) ptr++;	<span class="hljs-comment">/* Skip escaped quotes. */</span><br>	<br>	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len<span class="hljs-number">+1</span>);	<span class="hljs-comment">/* This is how long we need for the string, roughly. */</span><br>	<span class="hljs-keyword">if</span> (!out) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<br>	ptr=str<span class="hljs-number">+1</span>;ptr2=out;<br>	<span class="hljs-keyword">while</span> (*ptr!=<span class="hljs-string">&#x27;\&quot;&#x27;</span> &amp;&amp; *ptr)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (*ptr!=<span class="hljs-string">&#x27;\\&#x27;</span>) *ptr2++=*ptr++;<br>		<span class="hljs-keyword">else</span><br>		&#123;<br>			ptr++;<br>			<span class="hljs-keyword">switch</span> (*ptr)<br>			&#123;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;b&#x27;</span>: *ptr2++=<span class="hljs-string">&#x27;\b&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;f&#x27;</span>: *ptr2++=<span class="hljs-string">&#x27;\f&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;n&#x27;</span>: *ptr2++=<span class="hljs-string">&#x27;\n&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;r&#x27;</span>: *ptr2++=<span class="hljs-string">&#x27;\r&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;t&#x27;</span>: *ptr2++=<span class="hljs-string">&#x27;\t&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;u&#x27;</span>:	 <span class="hljs-comment">/* transcode utf16 to utf8. */</span><br>					uc=<span class="hljs-built_in">parse_hex4</span>(ptr<span class="hljs-number">+1</span>);ptr+=<span class="hljs-number">4</span>;	<span class="hljs-comment">/* get the unicode char. */</span><br><br>					<span class="hljs-keyword">if</span> ((uc&gt;=<span class="hljs-number">0xDC00</span> &amp;&amp; uc&lt;=<span class="hljs-number">0xDFFF</span>) || uc==<span class="hljs-number">0</span>)	<span class="hljs-keyword">break</span>;	<span class="hljs-comment">/* check for invalid.	*/</span><br><br>					<span class="hljs-keyword">if</span> (uc&gt;=<span class="hljs-number">0xD800</span> &amp;&amp; uc&lt;=<span class="hljs-number">0xDBFF</span>)	<span class="hljs-comment">/* UTF16 surrogate pairs.	*/</span><br>					&#123;<br>						<span class="hljs-keyword">if</span> (ptr[<span class="hljs-number">1</span>]!=<span class="hljs-string">&#x27;\\&#x27;</span> || ptr[<span class="hljs-number">2</span>]!=<span class="hljs-string">&#x27;u&#x27;</span>)	<span class="hljs-keyword">break</span>;	<span class="hljs-comment">/* missing second-half of surrogate.	*/</span><br>						uc2=<span class="hljs-built_in">parse_hex4</span>(ptr<span class="hljs-number">+3</span>);ptr+=<span class="hljs-number">6</span>;<br>						<span class="hljs-keyword">if</span> (uc2&lt;<span class="hljs-number">0xDC00</span> || uc2&gt;<span class="hljs-number">0xDFFF</span>)		<span class="hljs-keyword">break</span>;	<span class="hljs-comment">/* invalid second-half of surrogate.	*/</span><br>						uc=<span class="hljs-number">0x10000</span> + (((uc&amp;<span class="hljs-number">0x3FF</span>)&lt;&lt;<span class="hljs-number">10</span>) | (uc2&amp;<span class="hljs-number">0x3FF</span>));<br>					&#125;<br><br>					len=<span class="hljs-number">4</span>;<span class="hljs-keyword">if</span> (uc&lt;<span class="hljs-number">0x80</span>) len=<span class="hljs-number">1</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (uc&lt;<span class="hljs-number">0x800</span>) len=<span class="hljs-number">2</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (uc&lt;<span class="hljs-number">0x10000</span>) len=<span class="hljs-number">3</span>; ptr2+=len;<br>					<br>					<span class="hljs-keyword">switch</span> (len) &#123;<br>						<span class="hljs-keyword">case</span> <span class="hljs-number">4</span>: *--ptr2 =((uc | <span class="hljs-number">0x80</span>) &amp; <span class="hljs-number">0xBF</span>); uc &gt;&gt;= <span class="hljs-number">6</span>;<br>						<span class="hljs-keyword">case</span> <span class="hljs-number">3</span>: *--ptr2 =((uc | <span class="hljs-number">0x80</span>) &amp; <span class="hljs-number">0xBF</span>); uc &gt;&gt;= <span class="hljs-number">6</span>;<br>						<span class="hljs-keyword">case</span> <span class="hljs-number">2</span>: *--ptr2 =((uc | <span class="hljs-number">0x80</span>) &amp; <span class="hljs-number">0xBF</span>); uc &gt;&gt;= <span class="hljs-number">6</span>;<br>						<span class="hljs-keyword">case</span> <span class="hljs-number">1</span>: *--ptr2 =(uc | firstByteMark[len]);<br>					&#125;<br>					ptr2+=len;<br>					<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">default</span>:  *ptr2++=*ptr; <span class="hljs-keyword">break</span>;<br>			&#125;<br>			ptr++;<br>		&#125;<br>	&#125;<br>	*ptr2=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (*ptr==<span class="hljs-string">&#x27;\&quot;&#x27;</span>) ptr++;<br>	item-&gt;valuestring=out;<br>	item-&gt;type=cJSON_String;<br>	<span class="hljs-keyword">return</span> ptr;<br>&#125;<br><br><span class="hljs-comment">/* Render the cstring provided to an escaped version that can be printed. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_string_ptr</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *str,printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">const</span> <span class="hljs-type">char</span> *ptr;<span class="hljs-type">char</span> *ptr2,*out;<span class="hljs-type">int</span> len=<span class="hljs-number">0</span>,flag=<span class="hljs-number">0</span>;<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> token;<br>	<br>	<span class="hljs-keyword">for</span> (ptr=str;*ptr;ptr++) flag|=((*ptr&gt;<span class="hljs-number">0</span> &amp;&amp; *ptr&lt;<span class="hljs-number">32</span>)||(*ptr==<span class="hljs-string">&#x27;\&quot;&#x27;</span>)||(*ptr==<span class="hljs-string">&#x27;\\&#x27;</span>))?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (!flag)<br>	&#123;<br>		len=ptr-str;<br>		<span class="hljs-keyword">if</span> (p) out=<span class="hljs-built_in">ensure</span>(p,len<span class="hljs-number">+3</span>);<br>		<span class="hljs-keyword">else</span>		out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len<span class="hljs-number">+3</span>);<br>		<span class="hljs-keyword">if</span> (!out) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		ptr2=out;*ptr2++=<span class="hljs-string">&#x27;\&quot;&#x27;</span>;<br>		<span class="hljs-built_in">strcpy</span>(ptr2,str);<br>		ptr2[len]=<span class="hljs-string">&#x27;\&quot;&#x27;</span>;<br>		ptr2[len<span class="hljs-number">+1</span>]=<span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">return</span> out;<br>	&#125;<br>	<br>	<span class="hljs-keyword">if</span> (!str)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (p)	out=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">else</span>	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">if</span> (!out) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		<span class="hljs-built_in">strcpy</span>(out,<span class="hljs-string">&quot;\&quot;\&quot;&quot;</span>);<br>		<span class="hljs-keyword">return</span> out;<br>	&#125;<br>	ptr=str;<span class="hljs-keyword">while</span> ((token=*ptr) &amp;&amp; ++len) &#123;<span class="hljs-keyword">if</span> (<span class="hljs-built_in">strchr</span>(<span class="hljs-string">&quot;\&quot;\\\b\f\n\r\t&quot;</span>,token)) len++; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (token&lt;<span class="hljs-number">32</span>) len+=<span class="hljs-number">5</span>;ptr++;&#125;<br>	<br>	<span class="hljs-keyword">if</span> (p)	out=<span class="hljs-built_in">ensure</span>(p,len<span class="hljs-number">+3</span>);<br>	<span class="hljs-keyword">else</span>	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len<span class="hljs-number">+3</span>);<br>	<span class="hljs-keyword">if</span> (!out) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>	ptr2=out;ptr=str;<br>	*ptr2++=<span class="hljs-string">&#x27;\&quot;&#x27;</span>;<br>	<span class="hljs-keyword">while</span> (*ptr)<br>	&#123;<br>		<span class="hljs-keyword">if</span> ((<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)*ptr&gt;<span class="hljs-number">31</span> &amp;&amp; *ptr!=<span class="hljs-string">&#x27;\&quot;&#x27;</span> &amp;&amp; *ptr!=<span class="hljs-string">&#x27;\\&#x27;</span>) *ptr2++=*ptr++;<br>		<span class="hljs-keyword">else</span><br>		&#123;<br>			*ptr2++=<span class="hljs-string">&#x27;\\&#x27;</span>;<br>			<span class="hljs-keyword">switch</span> (token=*ptr++)<br>			&#123;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\\&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;\\&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\&quot;&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;\&quot;&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\b&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;b&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\f&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;f&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\n&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;n&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\r&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;r&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;\t&#x27;</span>:	*ptr2++=<span class="hljs-string">&#x27;t&#x27;</span>;	<span class="hljs-keyword">break</span>;<br>				<span class="hljs-keyword">default</span>: <span class="hljs-built_in">sprintf</span>(ptr2,<span class="hljs-string">&quot;u%04x&quot;</span>,token);ptr2+=<span class="hljs-number">5</span>;	<span class="hljs-keyword">break</span>;	<span class="hljs-comment">/* escape and print */</span><br>			&#125;<br>		&#125;<br>	&#125;<br>	*ptr2++=<span class="hljs-string">&#x27;\&quot;&#x27;</span>;*ptr2++=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">return</span> out;<br>&#125;<br><span class="hljs-comment">/* Invote print_string_ptr (which is useful) on an item. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_string</span><span class="hljs-params">(cJSON *item,printbuffer *p)</span>	</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">print_string_ptr</span>(item-&gt;valuestring,p);&#125;<br><br><span class="hljs-comment">/* Predeclare these prototypes. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_value</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span>;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_value</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span>;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_array</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span>;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_array</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span>;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_object</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span>;<br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_object</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span>;<br><br><span class="hljs-comment">/* Utility to jump whitespace and cr/lf */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">skip</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *in)</span> </span>&#123;<span class="hljs-keyword">while</span> (in &amp;&amp; *in &amp;&amp; (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>)*in&lt;=<span class="hljs-number">32</span>) in++; <span class="hljs-keyword">return</span> in;&#125;<br><br><span class="hljs-comment">/* Parse an object - create a new root, and populate. */</span><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_ParseWithOpts</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value,<span class="hljs-type">const</span> <span class="hljs-type">char</span> **return_parse_end,<span class="hljs-type">int</span> require_null_terminated)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">const</span> <span class="hljs-type">char</span> *end=<span class="hljs-number">0</span>;<br>	cJSON *c=<span class="hljs-built_in">cJSON_New_Item</span>();<br>	ep=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (!c) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;       <span class="hljs-comment">/* memory fail */</span><br><br>	end=<span class="hljs-built_in">parse_value</span>(c,<span class="hljs-built_in">skip</span>(value));<br>	<span class="hljs-keyword">if</span> (!end)	&#123;<span class="hljs-built_in">cJSON_Delete</span>(c);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* parse failure. ep is set. */</span><br><br>	<span class="hljs-comment">/* if we require null-terminated JSON without appended garbage, skip and then check for a null terminator */</span><br>	<span class="hljs-keyword">if</span> (require_null_terminated) &#123;end=<span class="hljs-built_in">skip</span>(end);<span class="hljs-keyword">if</span> (*end) &#123;<span class="hljs-built_in">cJSON_Delete</span>(c);ep=end;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;&#125;<br>	<span class="hljs-keyword">if</span> (return_parse_end) *return_parse_end=end;<br>	<span class="hljs-keyword">return</span> c;<br>&#125;<br><span class="hljs-comment">/* Default options for cJSON_Parse */</span><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_Parse</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span> </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">cJSON_ParseWithOpts</span>(value,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);&#125;<br><br><span class="hljs-comment">/* Render a cJSON item/entity/structure to text. */</span><br><span class="hljs-function"><span class="hljs-type">char</span> *<span class="hljs-title">cJSON_Print</span><span class="hljs-params">(cJSON *item)</span>				</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">print_value</span>(item,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">0</span>);&#125;<br><span class="hljs-function"><span class="hljs-type">char</span> *<span class="hljs-title">cJSON_PrintUnformatted</span><span class="hljs-params">(cJSON *item)</span>	</span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-built_in">print_value</span>(item,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>);&#125;<br><br><span class="hljs-function"><span class="hljs-type">char</span> *<span class="hljs-title">cJSON_PrintBuffered</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> prebuffer,<span class="hljs-type">int</span> fmt)</span></span><br><span class="hljs-function"></span>&#123;<br>	printbuffer p;<br>	p.buffer=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(prebuffer);<br>	p.length=prebuffer;<br>	p.offset=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">return</span> <span class="hljs-built_in">print_value</span>(item,<span class="hljs-number">0</span>,fmt,&amp;p);<br>	<span class="hljs-keyword">return</span> p.buffer;<br>&#125;<br><br><br><span class="hljs-comment">/* Parser core - when encountering text, process appropriately. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_value</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">if</span> (!value)						<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	<span class="hljs-comment">/* Fail on null. */</span><br>	<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strncmp</span>(value,<span class="hljs-string">&quot;null&quot;</span>,<span class="hljs-number">4</span>))	&#123; item-&gt;type=cJSON_NULL;  <span class="hljs-keyword">return</span> value<span class="hljs-number">+4</span>; &#125;<br>	<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strncmp</span>(value,<span class="hljs-string">&quot;false&quot;</span>,<span class="hljs-number">5</span>))	&#123; item-&gt;type=cJSON_False; <span class="hljs-keyword">return</span> value<span class="hljs-number">+5</span>; &#125;<br>	<span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strncmp</span>(value,<span class="hljs-string">&quot;true&quot;</span>,<span class="hljs-number">4</span>))	&#123; item-&gt;type=cJSON_True; item-&gt;valueint=<span class="hljs-number">1</span>;	<span class="hljs-keyword">return</span> value<span class="hljs-number">+4</span>; &#125;<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;\&quot;&#x27;</span>)				&#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">parse_string</span>(item,value); &#125;<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;-&#x27;</span> || (*value&gt;=<span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; *value&lt;=<span class="hljs-string">&#x27;9&#x27;</span>))	&#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">parse_number</span>(item,value); &#125;<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;[&#x27;</span>)				&#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">parse_array</span>(item,value); &#125;<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;&#123;&#x27;</span>)				&#123; <span class="hljs-keyword">return</span> <span class="hljs-built_in">parse_object</span>(item,value); &#125;<br><br>	ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	<span class="hljs-comment">/* failure. */</span><br>&#125;<br><br><span class="hljs-comment">/* Render a value to text. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_value</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> *out=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (p)<br>	&#123;<br>		<span class="hljs-keyword">switch</span> ((item-&gt;type)&amp;<span class="hljs-number">255</span>)<br>		&#123;<br>			<span class="hljs-keyword">case</span> cJSON_NULL:	&#123;out=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">5</span>);	<span class="hljs-keyword">if</span> (out) <span class="hljs-built_in">strcpy</span>(out,<span class="hljs-string">&quot;null&quot;</span>);	<span class="hljs-keyword">break</span>;&#125;<br>			<span class="hljs-keyword">case</span> cJSON_False:	&#123;out=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">6</span>);	<span class="hljs-keyword">if</span> (out) <span class="hljs-built_in">strcpy</span>(out,<span class="hljs-string">&quot;false&quot;</span>);	<span class="hljs-keyword">break</span>;&#125;<br>			<span class="hljs-keyword">case</span> cJSON_True:	&#123;out=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">5</span>);	<span class="hljs-keyword">if</span> (out) <span class="hljs-built_in">strcpy</span>(out,<span class="hljs-string">&quot;true&quot;</span>);	<span class="hljs-keyword">break</span>;&#125;<br>			<span class="hljs-keyword">case</span> cJSON_Number:	out=<span class="hljs-built_in">print_number</span>(item,p);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_String:	out=<span class="hljs-built_in">print_string</span>(item,p);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_Array:	out=<span class="hljs-built_in">print_array</span>(item,depth,fmt,p);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_Object:	out=<span class="hljs-built_in">print_object</span>(item,depth,fmt,p);<span class="hljs-keyword">break</span>;<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-keyword">switch</span> ((item-&gt;type)&amp;<span class="hljs-number">255</span>)<br>		&#123;<br>			<span class="hljs-keyword">case</span> cJSON_NULL:	out=<span class="hljs-built_in">cJSON_strdup</span>(<span class="hljs-string">&quot;null&quot;</span>);	<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_False:	out=<span class="hljs-built_in">cJSON_strdup</span>(<span class="hljs-string">&quot;false&quot;</span>);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_True:	out=<span class="hljs-built_in">cJSON_strdup</span>(<span class="hljs-string">&quot;true&quot;</span>); <span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_Number:	out=<span class="hljs-built_in">print_number</span>(item,<span class="hljs-number">0</span>);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_String:	out=<span class="hljs-built_in">print_string</span>(item,<span class="hljs-number">0</span>);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_Array:	out=<span class="hljs-built_in">print_array</span>(item,depth,fmt,<span class="hljs-number">0</span>);<span class="hljs-keyword">break</span>;<br>			<span class="hljs-keyword">case</span> cJSON_Object:	out=<span class="hljs-built_in">print_object</span>(item,depth,fmt,<span class="hljs-number">0</span>);<span class="hljs-keyword">break</span>;<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> out;<br>&#125;<br><br><span class="hljs-comment">/* Build an array from input text. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_array</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span><br><span class="hljs-function"></span>&#123;<br>	cJSON *child;<br>	<span class="hljs-keyword">if</span> (*value!=<span class="hljs-string">&#x27;[&#x27;</span>)	&#123;ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* not an array! */</span><br><br>	item-&gt;type=cJSON_Array;<br>	value=<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>);<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;]&#x27;</span>) <span class="hljs-keyword">return</span> value<span class="hljs-number">+1</span>;	<span class="hljs-comment">/* empty array. */</span><br><br>	item-&gt;child=child=<span class="hljs-built_in">cJSON_New_Item</span>();<br>	<span class="hljs-keyword">if</span> (!item-&gt;child) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;		 <span class="hljs-comment">/* memory fail */</span><br>	value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_value</span>(child,<span class="hljs-built_in">skip</span>(value)));	<span class="hljs-comment">/* skip any spacing, get the value. */</span><br>	<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br><br>	<span class="hljs-keyword">while</span> (*value==<span class="hljs-string">&#x27;,&#x27;</span>)<br>	&#123;<br>		cJSON *new_item;<br>		<span class="hljs-keyword">if</span> (!(new_item=<span class="hljs-built_in">cJSON_New_Item</span>())) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; 	<span class="hljs-comment">/* memory fail */</span><br>		child-&gt;next=new_item;new_item-&gt;prev=child;child=new_item;<br>		value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_value</span>(child,<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>)));<br>		<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	<span class="hljs-comment">/* memory fail */</span><br>	&#125;<br><br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;]&#x27;</span>) <span class="hljs-keyword">return</span> value<span class="hljs-number">+1</span>;	<span class="hljs-comment">/* end of array */</span><br>	ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	<span class="hljs-comment">/* malformed. */</span><br>&#125;<br><br><span class="hljs-comment">/* Render an array to text */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_array</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> **entries;<br>	<span class="hljs-type">char</span> *out=<span class="hljs-number">0</span>,*ptr,*ret;<span class="hljs-type">int</span> len=<span class="hljs-number">5</span>;<br>	cJSON *child=item-&gt;child;<br>	<span class="hljs-type">int</span> numentries=<span class="hljs-number">0</span>,i=<span class="hljs-number">0</span>,fail=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">size_t</span> tmplen=<span class="hljs-number">0</span>;<br>	<br>	<span class="hljs-comment">/* How many entries in the array? */</span><br>	<span class="hljs-keyword">while</span> (child) numentries++,child=child-&gt;next;<br>	<span class="hljs-comment">/* Explicitly handle numentries==0 */</span><br>	<span class="hljs-keyword">if</span> (!numentries)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (p)	out=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">else</span>	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">if</span> (out) <span class="hljs-built_in">strcpy</span>(out,<span class="hljs-string">&quot;[]&quot;</span>);<br>		<span class="hljs-keyword">return</span> out;<br>	&#125;<br><br>	<span class="hljs-keyword">if</span> (p)<br>	&#123;<br>		<span class="hljs-comment">/* Compose the output array. */</span><br>		i=p-&gt;offset;<br>		ptr=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">1</span>);<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	*ptr=<span class="hljs-string">&#x27;[&#x27;</span>;	p-&gt;offset++;<br>		child=item-&gt;child;<br>		<span class="hljs-keyword">while</span> (child &amp;&amp; !fail)<br>		&#123;<br>			<span class="hljs-built_in">print_value</span>(child,depth<span class="hljs-number">+1</span>,fmt,p);<br>			p-&gt;offset=<span class="hljs-built_in">update</span>(p);<br>			<span class="hljs-keyword">if</span> (child-&gt;next) &#123;len=fmt?<span class="hljs-number">2</span>:<span class="hljs-number">1</span>;ptr=<span class="hljs-built_in">ensure</span>(p,len<span class="hljs-number">+1</span>);<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;*ptr++=<span class="hljs-string">&#x27;,&#x27;</span>;<span class="hljs-keyword">if</span>(fmt)*ptr++=<span class="hljs-string">&#x27; &#x27;</span>;*ptr=<span class="hljs-number">0</span>;p-&gt;offset+=len;&#125;<br>			child=child-&gt;next;<br>		&#125;<br>		ptr=<span class="hljs-built_in">ensure</span>(p,<span class="hljs-number">2</span>);<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	*ptr++=<span class="hljs-string">&#x27;]&#x27;</span>;*ptr=<span class="hljs-number">0</span>;<br>		out=(p-&gt;buffer)+i;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-comment">/* Allocate an array to hold the values for each */</span><br>		entries=(<span class="hljs-type">char</span>**)<span class="hljs-built_in">cJSON_malloc</span>(numentries*<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*));<br>		<span class="hljs-keyword">if</span> (!entries) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		<span class="hljs-built_in">memset</span>(entries,<span class="hljs-number">0</span>,numentries*<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*));<br>		<span class="hljs-comment">/* Retrieve all the results: */</span><br>		child=item-&gt;child;<br>		<span class="hljs-keyword">while</span> (child &amp;&amp; !fail)<br>		&#123;<br>			ret=<span class="hljs-built_in">print_value</span>(child,depth<span class="hljs-number">+1</span>,fmt,<span class="hljs-number">0</span>);<br>			entries[i++]=ret;<br>			<span class="hljs-keyword">if</span> (ret) len+=<span class="hljs-built_in">strlen</span>(ret)<span class="hljs-number">+2</span>+(fmt?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>); <span class="hljs-keyword">else</span> fail=<span class="hljs-number">1</span>;<br>			child=child-&gt;next;<br>		&#125;<br>		<br>		<span class="hljs-comment">/* If we didn&#x27;t fail, try to malloc the output string */</span><br>		<span class="hljs-keyword">if</span> (!fail)	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len);<br>		<span class="hljs-comment">/* If that fails, we fail. */</span><br>		<span class="hljs-keyword">if</span> (!out) fail=<span class="hljs-number">1</span>;<br><br>		<span class="hljs-comment">/* Handle failure. */</span><br>		<span class="hljs-keyword">if</span> (fail)<br>		&#123;<br>			<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;numentries;i++) <span class="hljs-keyword">if</span> (entries[i]) <span class="hljs-built_in">cJSON_free</span>(entries[i]);<br>			<span class="hljs-built_in">cJSON_free</span>(entries);<br>			<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		&#125;<br>		<br>		<span class="hljs-comment">/* Compose the output array. */</span><br>		*out=<span class="hljs-string">&#x27;[&#x27;</span>;<br>		ptr=out<span class="hljs-number">+1</span>;*ptr=<span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;numentries;i++)<br>		&#123;<br>			tmplen=<span class="hljs-built_in">strlen</span>(entries[i]);<span class="hljs-built_in">memcpy</span>(ptr,entries[i],tmplen);ptr+=tmplen;<br>			<span class="hljs-keyword">if</span> (i!=numentries<span class="hljs-number">-1</span>) &#123;*ptr++=<span class="hljs-string">&#x27;,&#x27;</span>;<span class="hljs-keyword">if</span>(fmt)*ptr++=<span class="hljs-string">&#x27; &#x27;</span>;*ptr=<span class="hljs-number">0</span>;&#125;<br>			<span class="hljs-built_in">cJSON_free</span>(entries[i]);<br>		&#125;<br>		<span class="hljs-built_in">cJSON_free</span>(entries);<br>		*ptr++=<span class="hljs-string">&#x27;]&#x27;</span>;*ptr++=<span class="hljs-number">0</span>;<br>	&#125;<br>	<span class="hljs-keyword">return</span> out;	<br>&#125;<br><br><span class="hljs-comment">/* Build an object from the text. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">const</span> <span class="hljs-type">char</span> *<span class="hljs-title">parse_object</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *value)</span></span><br><span class="hljs-function"></span>&#123;<br>	cJSON *child;<br>	<span class="hljs-keyword">if</span> (*value!=<span class="hljs-string">&#x27;&#123;&#x27;</span>)	&#123;ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* not an object! */</span><br>	<br>	item-&gt;type=cJSON_Object;<br>	value=<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>);<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;&#125;&#x27;</span>) <span class="hljs-keyword">return</span> value<span class="hljs-number">+1</span>;	<span class="hljs-comment">/* empty array. */</span><br>	<br>	item-&gt;child=child=<span class="hljs-built_in">cJSON_New_Item</span>();<br>	<span class="hljs-keyword">if</span> (!item-&gt;child) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_string</span>(child,<span class="hljs-built_in">skip</span>(value)));<br>	<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	child-&gt;string=child-&gt;valuestring;child-&gt;valuestring=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (*value!=<span class="hljs-string">&#x27;:&#x27;</span>) &#123;ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* fail! */</span><br>	value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_value</span>(child,<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>)));	<span class="hljs-comment">/* skip any spacing, get the value. */</span><br>	<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<br>	<span class="hljs-keyword">while</span> (*value==<span class="hljs-string">&#x27;,&#x27;</span>)<br>	&#123;<br>		cJSON *new_item;<br>		<span class="hljs-keyword">if</span> (!(new_item=<span class="hljs-built_in">cJSON_New_Item</span>()))	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; <span class="hljs-comment">/* memory fail */</span><br>		child-&gt;next=new_item;new_item-&gt;prev=child;child=new_item;<br>		value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_string</span>(child,<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>)));<br>		<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		child-&gt;string=child-&gt;valuestring;child-&gt;valuestring=<span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">if</span> (*value!=<span class="hljs-string">&#x27;:&#x27;</span>) &#123;ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;	<span class="hljs-comment">/* fail! */</span><br>		value=<span class="hljs-built_in">skip</span>(<span class="hljs-built_in">parse_value</span>(child,<span class="hljs-built_in">skip</span>(value<span class="hljs-number">+1</span>)));	<span class="hljs-comment">/* skip any spacing, get the value. */</span><br>		<span class="hljs-keyword">if</span> (!value) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	&#125;<br>	<br>	<span class="hljs-keyword">if</span> (*value==<span class="hljs-string">&#x27;&#125;&#x27;</span>) <span class="hljs-keyword">return</span> value<span class="hljs-number">+1</span>;	<span class="hljs-comment">/* end of array */</span><br>	ep=value;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;	<span class="hljs-comment">/* malformed. */</span><br>&#125;<br><br><span class="hljs-comment">/* Render an object to text. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">char</span> *<span class="hljs-title">print_object</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> depth,<span class="hljs-type">int</span> fmt,printbuffer *p)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> **entries=<span class="hljs-number">0</span>,**names=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">char</span> *out=<span class="hljs-number">0</span>,*ptr,*ret,*str;<span class="hljs-type">int</span> len=<span class="hljs-number">7</span>,i=<span class="hljs-number">0</span>,j;<br>	cJSON *child=item-&gt;child;<br>	<span class="hljs-type">int</span> numentries=<span class="hljs-number">0</span>,fail=<span class="hljs-number">0</span>;<br>	<span class="hljs-type">size_t</span> tmplen=<span class="hljs-number">0</span>;<br>	<span class="hljs-comment">/* Count the number of entries. */</span><br>	<span class="hljs-keyword">while</span> (child) numentries++,child=child-&gt;next;<br>	<span class="hljs-comment">/* Explicitly handle empty object case */</span><br>	<span class="hljs-keyword">if</span> (!numentries)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (p) out=<span class="hljs-built_in">ensure</span>(p,fmt?depth<span class="hljs-number">+4</span>:<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">else</span>	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(fmt?depth<span class="hljs-number">+4</span>:<span class="hljs-number">3</span>);<br>		<span class="hljs-keyword">if</span> (!out)	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		ptr=out;*ptr++=<span class="hljs-string">&#x27;&#123;&#x27;</span>;<br>		<span class="hljs-keyword">if</span> (fmt) &#123;*ptr++=<span class="hljs-string">&#x27;\n&#x27;</span>;<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;depth<span class="hljs-number">-1</span>;i++) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;&#125;<br>		*ptr++=<span class="hljs-string">&#x27;&#125;&#x27;</span>;*ptr++=<span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">return</span> out;<br>	&#125;<br>	<span class="hljs-keyword">if</span> (p)<br>	&#123;<br>		<span class="hljs-comment">/* Compose the output: */</span><br>		i=p-&gt;offset;<br>		len=fmt?<span class="hljs-number">2</span>:<span class="hljs-number">1</span>;	ptr=<span class="hljs-built_in">ensure</span>(p,len<span class="hljs-number">+1</span>);	<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		*ptr++=<span class="hljs-string">&#x27;&#123;&#x27;</span>;	<span class="hljs-keyword">if</span> (fmt) *ptr++=<span class="hljs-string">&#x27;\n&#x27;</span>;	*ptr=<span class="hljs-number">0</span>;	p-&gt;offset+=len;<br>		child=item-&gt;child;depth++;<br>		<span class="hljs-keyword">while</span> (child)<br>		&#123;<br>			<span class="hljs-keyword">if</span> (fmt)<br>			&#123;<br>				ptr=<span class="hljs-built_in">ensure</span>(p,depth);	<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>				<span class="hljs-keyword">for</span> (j=<span class="hljs-number">0</span>;j&lt;depth;j++) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>				p-&gt;offset+=depth;<br>			&#125;<br>			<span class="hljs-built_in">print_string_ptr</span>(child-&gt;string,p);<br>			p-&gt;offset=<span class="hljs-built_in">update</span>(p);<br>			<br>			len=fmt?<span class="hljs-number">2</span>:<span class="hljs-number">1</span>;<br>			ptr=<span class="hljs-built_in">ensure</span>(p,len);	<span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>			*ptr++=<span class="hljs-string">&#x27;:&#x27;</span>;<span class="hljs-keyword">if</span> (fmt) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>			p-&gt;offset+=len;<br>			<br>			<span class="hljs-built_in">print_value</span>(child,depth,fmt,p);<br>			p-&gt;offset=<span class="hljs-built_in">update</span>(p);<br><br>			len=(fmt?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>)+(child-&gt;next?<span class="hljs-number">1</span>:<span class="hljs-number">0</span>);<br>			ptr=<span class="hljs-built_in">ensure</span>(p,len<span class="hljs-number">+1</span>); <span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>			<span class="hljs-keyword">if</span> (child-&gt;next) *ptr++=<span class="hljs-string">&#x27;,&#x27;</span>;<br>			<span class="hljs-keyword">if</span> (fmt) *ptr++=<span class="hljs-string">&#x27;\n&#x27;</span>;*ptr=<span class="hljs-number">0</span>;<br>			p-&gt;offset+=len;<br>			child=child-&gt;next;<br>		&#125;<br>		ptr=<span class="hljs-built_in">ensure</span>(p,fmt?(depth<span class="hljs-number">+1</span>):<span class="hljs-number">2</span>);	 <span class="hljs-keyword">if</span> (!ptr) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">if</span> (fmt)	<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;depth<span class="hljs-number">-1</span>;i++) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>		*ptr++=<span class="hljs-string">&#x27;&#125;&#x27;</span>;*ptr=<span class="hljs-number">0</span>;<br>		out=(p-&gt;buffer)+i;<br>	&#125;<br>	<span class="hljs-keyword">else</span><br>	&#123;<br>		<span class="hljs-comment">/* Allocate space for the names and the objects */</span><br>		entries=(<span class="hljs-type">char</span>**)<span class="hljs-built_in">cJSON_malloc</span>(numentries*<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*));<br>		<span class="hljs-keyword">if</span> (!entries) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		names=(<span class="hljs-type">char</span>**)<span class="hljs-built_in">cJSON_malloc</span>(numentries*<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*));<br>		<span class="hljs-keyword">if</span> (!names) &#123;<span class="hljs-built_in">cJSON_free</span>(entries);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<br>		<span class="hljs-built_in">memset</span>(entries,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*)*numentries);<br>		<span class="hljs-built_in">memset</span>(names,<span class="hljs-number">0</span>,<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>*)*numentries);<br><br>		<span class="hljs-comment">/* Collect all the results into our arrays: */</span><br>		child=item-&gt;child;depth++;<span class="hljs-keyword">if</span> (fmt) len+=depth;<br>		<span class="hljs-keyword">while</span> (child)<br>		&#123;<br>			names[i]=str=<span class="hljs-built_in">print_string_ptr</span>(child-&gt;string,<span class="hljs-number">0</span>);<br>			entries[i++]=ret=<span class="hljs-built_in">print_value</span>(child,depth,fmt,<span class="hljs-number">0</span>);<br>			<span class="hljs-keyword">if</span> (str &amp;&amp; ret) len+=<span class="hljs-built_in">strlen</span>(ret)+<span class="hljs-built_in">strlen</span>(str)<span class="hljs-number">+2</span>+(fmt?<span class="hljs-number">2</span>+depth:<span class="hljs-number">0</span>); <span class="hljs-keyword">else</span> fail=<span class="hljs-number">1</span>;<br>			child=child-&gt;next;<br>		&#125;<br>		<br>		<span class="hljs-comment">/* Try to allocate the output string */</span><br>		<span class="hljs-keyword">if</span> (!fail)	out=(<span class="hljs-type">char</span>*)<span class="hljs-built_in">cJSON_malloc</span>(len);<br>		<span class="hljs-keyword">if</span> (!out) fail=<span class="hljs-number">1</span>;<br><br>		<span class="hljs-comment">/* Handle failure */</span><br>		<span class="hljs-keyword">if</span> (fail)<br>		&#123;<br>			<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;numentries;i++) &#123;<span class="hljs-keyword">if</span> (names[i]) <span class="hljs-built_in">cJSON_free</span>(names[i]);<span class="hljs-keyword">if</span> (entries[i]) <span class="hljs-built_in">cJSON_free</span>(entries[i]);&#125;<br>			<span class="hljs-built_in">cJSON_free</span>(names);<span class="hljs-built_in">cJSON_free</span>(entries);<br>			<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>		&#125;<br>		<br>		<span class="hljs-comment">/* Compose the output: */</span><br>		*out=<span class="hljs-string">&#x27;&#123;&#x27;</span>;ptr=out<span class="hljs-number">+1</span>;<span class="hljs-keyword">if</span> (fmt)*ptr++=<span class="hljs-string">&#x27;\n&#x27;</span>;*ptr=<span class="hljs-number">0</span>;<br>		<span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;numentries;i++)<br>		&#123;<br>			<span class="hljs-keyword">if</span> (fmt) <span class="hljs-keyword">for</span> (j=<span class="hljs-number">0</span>;j&lt;depth;j++) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>			tmplen=<span class="hljs-built_in">strlen</span>(names[i]);<span class="hljs-built_in">memcpy</span>(ptr,names[i],tmplen);ptr+=tmplen;<br>			*ptr++=<span class="hljs-string">&#x27;:&#x27;</span>;<span class="hljs-keyword">if</span> (fmt) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>			<span class="hljs-built_in">strcpy</span>(ptr,entries[i]);ptr+=<span class="hljs-built_in">strlen</span>(entries[i]);<br>			<span class="hljs-keyword">if</span> (i!=numentries<span class="hljs-number">-1</span>) *ptr++=<span class="hljs-string">&#x27;,&#x27;</span>;<br>			<span class="hljs-keyword">if</span> (fmt) *ptr++=<span class="hljs-string">&#x27;\n&#x27;</span>;*ptr=<span class="hljs-number">0</span>;<br>			<span class="hljs-built_in">cJSON_free</span>(names[i]);<span class="hljs-built_in">cJSON_free</span>(entries[i]);<br>		&#125;<br>		<br>		<span class="hljs-built_in">cJSON_free</span>(names);<span class="hljs-built_in">cJSON_free</span>(entries);<br>		<span class="hljs-keyword">if</span> (fmt) <span class="hljs-keyword">for</span> (i=<span class="hljs-number">0</span>;i&lt;depth<span class="hljs-number">-1</span>;i++) *ptr++=<span class="hljs-string">&#x27;\t&#x27;</span>;<br>		*ptr++=<span class="hljs-string">&#x27;&#125;&#x27;</span>;*ptr++=<span class="hljs-number">0</span>;<br>	&#125;<br>	<span class="hljs-keyword">return</span> out;	<br>&#125;<br><br><span class="hljs-comment">/* Get Array size/item / object item. */</span><br><span class="hljs-function"><span class="hljs-type">int</span>    <span class="hljs-title">cJSON_GetArraySize</span><span class="hljs-params">(cJSON *array)</span>							</span>&#123;cJSON *c=array-&gt;child;<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;<span class="hljs-keyword">while</span>(c)i++,c=c-&gt;next;<span class="hljs-keyword">return</span> i;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_GetArrayItem</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> item)</span>				</span>&#123;cJSON *c=array-&gt;child;  <span class="hljs-keyword">while</span> (c &amp;&amp; item&gt;<span class="hljs-number">0</span>) item--,c=c-&gt;next; <span class="hljs-keyword">return</span> c;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_GetObjectItem</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span>	</span>&#123;cJSON *c=object-&gt;child; <span class="hljs-keyword">while</span> (c &amp;&amp; <span class="hljs-built_in">cJSON_strcasecmp</span>(c-&gt;string,string)) c=c-&gt;next; <span class="hljs-keyword">return</span> c;&#125;<br><br><span class="hljs-comment">/* Utility for array list handling. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> <span class="hljs-type">void</span> <span class="hljs-title">suffix_object</span><span class="hljs-params">(cJSON *prev,cJSON *item)</span> </span>&#123;prev-&gt;next=item;item-&gt;prev=prev;&#125;<br><span class="hljs-comment">/* Utility for handling references. */</span><br><span class="hljs-function"><span class="hljs-type">static</span> cJSON *<span class="hljs-title">create_reference</span><span class="hljs-params">(cJSON *item)</span> </span>&#123;cJSON *ref=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span> (!ref) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-built_in">memcpy</span>(ref,item,<span class="hljs-built_in">sizeof</span>(cJSON));ref-&gt;string=<span class="hljs-number">0</span>;ref-&gt;type|=cJSON_IsReference;ref-&gt;next=ref-&gt;prev=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> ref;&#125;<br><br><span class="hljs-comment">/* Add item to array/object. */</span><br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_AddItemToArray</span><span class="hljs-params">(cJSON *array, cJSON *item)</span>						</span>&#123;cJSON *c=array-&gt;child;<span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span>; <span class="hljs-keyword">if</span> (!c) &#123;array-&gt;child=item;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">while</span> (c &amp;&amp; c-&gt;next) c=c-&gt;next; <span class="hljs-built_in">suffix_object</span>(c,item);&#125;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_AddItemToObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span>	</span>&#123;<span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span>; <span class="hljs-keyword">if</span> (item-&gt;string) <span class="hljs-built_in">cJSON_free</span>(item-&gt;string);item-&gt;string=<span class="hljs-built_in">cJSON_strdup</span>(string);<span class="hljs-built_in">cJSON_AddItemToArray</span>(object,item);&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_AddItemToObjectCS</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span>	</span>&#123;<span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span>; <span class="hljs-keyword">if</span> (!(item-&gt;type&amp;cJSON_StringIsConst) &amp;&amp; item-&gt;string) <span class="hljs-built_in">cJSON_free</span>(item-&gt;string);item-&gt;string=(<span class="hljs-type">char</span>*)string;item-&gt;type|=cJSON_StringIsConst;<span class="hljs-built_in">cJSON_AddItemToArray</span>(object,item);&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>	<span class="hljs-title">cJSON_AddItemReferenceToArray</span><span class="hljs-params">(cJSON *array, cJSON *item)</span>						</span>&#123;<span class="hljs-built_in">cJSON_AddItemToArray</span>(array,<span class="hljs-built_in">create_reference</span>(item));&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>	<span class="hljs-title">cJSON_AddItemReferenceToObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *item)</span>	</span>&#123;<span class="hljs-built_in">cJSON_AddItemToObject</span>(object,string,<span class="hljs-built_in">create_reference</span>(item));&#125;<br><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_DetachItemFromArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which)</span>			</span>&#123;cJSON *c=array-&gt;child;<span class="hljs-keyword">while</span> (c &amp;&amp; which&gt;<span class="hljs-number">0</span>) c=c-&gt;next,which--;<span class="hljs-keyword">if</span> (!c) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">if</span> (c-&gt;prev) c-&gt;prev-&gt;next=c-&gt;next;<span class="hljs-keyword">if</span> (c-&gt;next) c-&gt;next-&gt;prev=c-&gt;prev;<span class="hljs-keyword">if</span> (c==array-&gt;child) array-&gt;child=c-&gt;next;c-&gt;prev=c-&gt;next=<span class="hljs-number">0</span>;<span class="hljs-keyword">return</span> c;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_DeleteItemFromArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which)</span>			</span>&#123;<span class="hljs-built_in">cJSON_Delete</span>(<span class="hljs-built_in">cJSON_DetachItemFromArray</span>(array,which));&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_DetachItemFromObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span> </span>&#123;<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;cJSON *c=object-&gt;child;<span class="hljs-keyword">while</span> (c &amp;&amp; <span class="hljs-built_in">cJSON_strcasecmp</span>(c-&gt;string,string)) i++,c=c-&gt;next;<span class="hljs-keyword">if</span> (c) <span class="hljs-keyword">return</span> <span class="hljs-built_in">cJSON_DetachItemFromArray</span>(object,i);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_DeleteItemFromObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span> </span>&#123;<span class="hljs-built_in">cJSON_Delete</span>(<span class="hljs-built_in">cJSON_DetachItemFromObject</span>(object,string));&#125;<br><br><span class="hljs-comment">/* Replace array/object items with new ones. */</span><br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_InsertItemInArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which,cJSON *newitem)</span>		</span>&#123;cJSON *c=array-&gt;child;<span class="hljs-keyword">while</span> (c &amp;&amp; which&gt;<span class="hljs-number">0</span>) c=c-&gt;next,which--;<span class="hljs-keyword">if</span> (!c) &#123;<span class="hljs-built_in">cJSON_AddItemToArray</span>(array,newitem);<span class="hljs-keyword">return</span>;&#125;<br>	newitem-&gt;next=c;newitem-&gt;prev=c-&gt;prev;c-&gt;prev=newitem;<span class="hljs-keyword">if</span> (c==array-&gt;child) array-&gt;child=newitem; <span class="hljs-keyword">else</span> newitem-&gt;prev-&gt;next=newitem;&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_ReplaceItemInArray</span><span class="hljs-params">(cJSON *array,<span class="hljs-type">int</span> which,cJSON *newitem)</span>		</span>&#123;cJSON *c=array-&gt;child;<span class="hljs-keyword">while</span> (c &amp;&amp; which&gt;<span class="hljs-number">0</span>) c=c-&gt;next,which--;<span class="hljs-keyword">if</span> (!c) <span class="hljs-keyword">return</span>;<br>	newitem-&gt;next=c-&gt;next;newitem-&gt;prev=c-&gt;prev;<span class="hljs-keyword">if</span> (newitem-&gt;next) newitem-&gt;next-&gt;prev=newitem;<br>	<span class="hljs-keyword">if</span> (c==array-&gt;child) array-&gt;child=newitem; <span class="hljs-keyword">else</span> newitem-&gt;prev-&gt;next=newitem;c-&gt;next=c-&gt;prev=<span class="hljs-number">0</span>;<span class="hljs-built_in">cJSON_Delete</span>(c);&#125;<br><span class="hljs-function"><span class="hljs-type">void</span>   <span class="hljs-title">cJSON_ReplaceItemInObject</span><span class="hljs-params">(cJSON *object,<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string,cJSON *newitem)</span></span>&#123;<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;cJSON *c=object-&gt;child;<span class="hljs-keyword">while</span>(c &amp;&amp; <span class="hljs-built_in">cJSON_strcasecmp</span>(c-&gt;string,string))i++,c=c-&gt;next;<span class="hljs-keyword">if</span>(c)&#123;newitem-&gt;string=<span class="hljs-built_in">cJSON_strdup</span>(string);<span class="hljs-built_in">cJSON_ReplaceItemInArray</span>(object,i,newitem);&#125;&#125;<br><br><span class="hljs-comment">/* Create basic types: */</span><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateNull</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=cJSON_NULL;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateTrue</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=cJSON_True;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateFalse</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=cJSON_False;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateBool</span><span class="hljs-params">(<span class="hljs-type">int</span> b)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=b?cJSON_True:cJSON_False;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateNumber</span><span class="hljs-params">(<span class="hljs-type">double</span> num)</span>			</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)&#123;item-&gt;type=cJSON_Number;item-&gt;valuedouble=num;item-&gt;valueint=(<span class="hljs-type">int</span>)num;&#125;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateString</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> *string)</span>	</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)&#123;item-&gt;type=cJSON_String;item-&gt;valuestring=<span class="hljs-built_in">cJSON_strdup</span>(string);&#125;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateArray</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=cJSON_Array;<span class="hljs-keyword">return</span> item;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateObject</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span>					</span>&#123;cJSON *item=<span class="hljs-built_in">cJSON_New_Item</span>();<span class="hljs-keyword">if</span>(item)item-&gt;type=cJSON_Object;<span class="hljs-keyword">return</span> item;&#125;<br><br><span class="hljs-comment">/* Create Arrays: */</span><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateIntArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">int</span> *numbers,<span class="hljs-type">int</span> count)</span>		</span>&#123;<span class="hljs-type">int</span> i;cJSON *n=<span class="hljs-number">0</span>,*p=<span class="hljs-number">0</span>,*a=<span class="hljs-built_in">cJSON_CreateArray</span>();<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;a &amp;&amp; i&lt;count;i++)&#123;n=<span class="hljs-built_in">cJSON_CreateNumber</span>(numbers[i]);<span class="hljs-keyword">if</span>(!i)a-&gt;child=n;<span class="hljs-keyword">else</span> <span class="hljs-built_in">suffix_object</span>(p,n);p=n;&#125;<span class="hljs-keyword">return</span> a;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateFloatArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">float</span> *numbers,<span class="hljs-type">int</span> count)</span>	</span>&#123;<span class="hljs-type">int</span> i;cJSON *n=<span class="hljs-number">0</span>,*p=<span class="hljs-number">0</span>,*a=<span class="hljs-built_in">cJSON_CreateArray</span>();<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;a &amp;&amp; i&lt;count;i++)&#123;n=<span class="hljs-built_in">cJSON_CreateNumber</span>(numbers[i]);<span class="hljs-keyword">if</span>(!i)a-&gt;child=n;<span class="hljs-keyword">else</span> <span class="hljs-built_in">suffix_object</span>(p,n);p=n;&#125;<span class="hljs-keyword">return</span> a;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateDoubleArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">double</span> *numbers,<span class="hljs-type">int</span> count)</span>	</span>&#123;<span class="hljs-type">int</span> i;cJSON *n=<span class="hljs-number">0</span>,*p=<span class="hljs-number">0</span>,*a=<span class="hljs-built_in">cJSON_CreateArray</span>();<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;a &amp;&amp; i&lt;count;i++)&#123;n=<span class="hljs-built_in">cJSON_CreateNumber</span>(numbers[i]);<span class="hljs-keyword">if</span>(!i)a-&gt;child=n;<span class="hljs-keyword">else</span> <span class="hljs-built_in">suffix_object</span>(p,n);p=n;&#125;<span class="hljs-keyword">return</span> a;&#125;<br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_CreateStringArray</span><span class="hljs-params">(<span class="hljs-type">const</span> <span class="hljs-type">char</span> **strings,<span class="hljs-type">int</span> count)</span>	</span>&#123;<span class="hljs-type">int</span> i;cJSON *n=<span class="hljs-number">0</span>,*p=<span class="hljs-number">0</span>,*a=<span class="hljs-built_in">cJSON_CreateArray</span>();<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;a &amp;&amp; i&lt;count;i++)&#123;n=<span class="hljs-built_in">cJSON_CreateString</span>(strings[i]);<span class="hljs-keyword">if</span>(!i)a-&gt;child=n;<span class="hljs-keyword">else</span> <span class="hljs-built_in">suffix_object</span>(p,n);p=n;&#125;<span class="hljs-keyword">return</span> a;&#125;<br><br><span class="hljs-comment">/* Duplication */</span><br><span class="hljs-function">cJSON *<span class="hljs-title">cJSON_Duplicate</span><span class="hljs-params">(cJSON *item,<span class="hljs-type">int</span> recurse)</span></span><br><span class="hljs-function"></span>&#123;<br>	cJSON *newitem,*cptr,*nptr=<span class="hljs-number">0</span>,*newchild;<br>	<span class="hljs-comment">/* Bail on bad ptr */</span><br>	<span class="hljs-keyword">if</span> (!item) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-comment">/* Create new item */</span><br>	newitem=<span class="hljs-built_in">cJSON_New_Item</span>();<br>	<span class="hljs-keyword">if</span> (!newitem) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	<span class="hljs-comment">/* Copy over all vars */</span><br>	newitem-&gt;type=item-&gt;type&amp;(~cJSON_IsReference),newitem-&gt;valueint=item-&gt;valueint,newitem-&gt;valuedouble=item-&gt;valuedouble;<br>	<span class="hljs-keyword">if</span> (item-&gt;valuestring)	&#123;newitem-&gt;valuestring=<span class="hljs-built_in">cJSON_strdup</span>(item-&gt;valuestring);	<span class="hljs-keyword">if</span> (!newitem-&gt;valuestring)	&#123;<span class="hljs-built_in">cJSON_Delete</span>(newitem);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;&#125;<br>	<span class="hljs-keyword">if</span> (item-&gt;string)		&#123;newitem-&gt;string=<span class="hljs-built_in">cJSON_strdup</span>(item-&gt;string);			<span class="hljs-keyword">if</span> (!newitem-&gt;string)		&#123;<span class="hljs-built_in">cJSON_Delete</span>(newitem);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;&#125;<br>	<span class="hljs-comment">/* If non-recursive, then we&#x27;re done! */</span><br>	<span class="hljs-keyword">if</span> (!recurse) <span class="hljs-keyword">return</span> newitem;<br>	<span class="hljs-comment">/* Walk the -&gt;next chain for the child. */</span><br>	cptr=item-&gt;child;<br>	<span class="hljs-keyword">while</span> (cptr)<br>	&#123;<br>		newchild=<span class="hljs-built_in">cJSON_Duplicate</span>(cptr,<span class="hljs-number">1</span>);		<span class="hljs-comment">/* Duplicate (with recurse) each item in the -&gt;next chain */</span><br>		<span class="hljs-keyword">if</span> (!newchild) &#123;<span class="hljs-built_in">cJSON_Delete</span>(newitem);<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;<br>		<span class="hljs-keyword">if</span> (nptr)	&#123;nptr-&gt;next=newchild,newchild-&gt;prev=nptr;nptr=newchild;&#125;	<span class="hljs-comment">/* If newitem-&gt;child already set, then crosswire -&gt;prev and -&gt;next and move on */</span><br>		<span class="hljs-keyword">else</span>		&#123;newitem-&gt;child=newchild;nptr=newchild;&#125;					<span class="hljs-comment">/* Set newitem-&gt;child and move to it */</span><br>		cptr=cptr-&gt;next;<br>	&#125;<br>	<span class="hljs-keyword">return</span> newitem;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">cJSON_Minify</span><span class="hljs-params">(<span class="hljs-type">char</span> *json)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-type">char</span> *into=json;<br>	<span class="hljs-keyword">while</span> (*json)<br>	&#123;<br>		<span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27; &#x27;</span>) json++;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;\t&#x27;</span>) json++;	<span class="hljs-comment">/* Whitespace characters. */</span><br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;\r&#x27;</span>) json++;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;\n&#x27;</span>) json++;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;/&#x27;</span> &amp;&amp; json[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;/&#x27;</span>)  <span class="hljs-keyword">while</span> (*json &amp;&amp; *json!=<span class="hljs-string">&#x27;\n&#x27;</span>) json++;	<span class="hljs-comment">/* double-slash comments, to end of line. */</span><br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;/&#x27;</span> &amp;&amp; json[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;*&#x27;</span>) &#123;<span class="hljs-keyword">while</span> (*json &amp;&amp; !(*json==<span class="hljs-string">&#x27;*&#x27;</span> &amp;&amp; json[<span class="hljs-number">1</span>]==<span class="hljs-string">&#x27;/&#x27;</span>)) json++;json+=<span class="hljs-number">2</span>;&#125;	<span class="hljs-comment">/* multiline comments. */</span><br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;\&quot;&#x27;</span>)&#123;*into++=*json++;<span class="hljs-keyword">while</span> (*json &amp;&amp; *json!=<span class="hljs-string">&#x27;\&quot;&#x27;</span>)&#123;<span class="hljs-keyword">if</span> (*json==<span class="hljs-string">&#x27;\\&#x27;</span>) *into++=*json++;*into++=*json++;&#125;*into++=*json++;&#125; <span class="hljs-comment">/* string literals, which are \&quot; sensitive. */</span><br>		<span class="hljs-keyword">else</span> *into++=*json++;			<span class="hljs-comment">/* All other characters. */</span><br>	&#125;<br>	*into=<span class="hljs-number">0</span>;	<span class="hljs-comment">/* and null-terminate. */</span><br>&#125;<br><br></code></pre></td></tr></table></figure>
</details>   
  
<p>CJSON主要数据结构如下，采用双向链表的形式：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-keyword">typedef</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> &#123;<br>　　<span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> *next,*prev;           <span class="hljs-comment">/* 遍历数组或对象链的前向或后向链表指针*/</span><br>　　<span class="hljs-keyword">struct</span> <span class="hljs-title class_">cJSON</span> *child;                <span class="hljs-comment">/*数组或对象的孩子节点*/</span><br>　　<span class="hljs-type">int</span> type;                           <span class="hljs-comment">/* key的类型*/</span><br>　　<span class="hljs-type">char</span> *valuestring;                  <span class="hljs-comment">/*字符串值*/</span><br>　　<span class="hljs-type">int</span> valueint;                       <span class="hljs-comment">/* 整数值*/</span><br>　　<span class="hljs-type">double</span> valuedouble;                 <span class="hljs-comment">/* 浮点数值*/</span><br>　　<span class="hljs-type">char</span> *string;                       <span class="hljs-comment">/* key的名字*/</span><br><br>&#125; cJSON;<br></code></pre></td></tr></table></figure>
<ol>
<li>cJSON是使用链表来存储数据的，其访问方式很像一颗树。每一个节点可以有兄弟节点，通过next&#x2F;prev指针来查找，它类似双向链表；每个节点也可以有孩子节点，通过child指针来访问，进入下一层。只有节点是对象或数组时才可以有孩子节点。</li>
<li>type是键（key）的类型，一共有7种取值，分别是：False，Ture，NULL，Number，String，Array，Object。<ul>
<li>若是Number类型，则valueint或valuedouble中存储着值。若期望的是int，则访问valueint，若期望的是double，则访问valuedouble，可以得到值。</li>
<li>若是String类型的，则valuestring中存储着值，可以访问valuestring得到值。</li>
</ul>
</li>
<li>string中存放的是这个节点的名字，可理解为key的名称。</li>
</ol>
<h3 id="接口函数"><a href="#接口函数" class="headerlink" title="接口函数"></a>接口函数</h3><p>重要的接口函数：</p>
<p>**1. cJSON <em>cJSON_Parse(const char <em>value);</em></em><br>解析JSON数据包，并按照cJSON结构体的结构序列化整个数据包。可以看做是获取一个句柄。<br>**2. cJSON *cJSON_GetObjectItem(cJSON <em>object,const char <em>string);</em></em><br>功能：获取json指定的对象成员<br>参数：<code>*objec</code>：第一个函数中获取的句柄。<code>string</code>：需要获取的对象<br>返回值：这个对象成员的句柄  如果json格式的对象成员直接就是字符串那么就可以直接通过结构体中的valuestring元素来获取这个成员的值<br>**3. cJSON <em>cJSON_GetArrayItem(cJSON <em>array,int item);</em></em><br>功能：有可能第二个函数中获取到的是成员对象值是一个数组，那么就需要用到这个函数。用来获取这个数组指定的下标对象<br>参数：<code>*array</code>：传入第二步中返回的值，<code>item</code>：想要获取这个数组的下标元素<br>返回值：这个数组中指定下标的对象。然后在对这个返回值重复使用第二步函数就可以获取到各个成员的值了。<br>也就是说对象是数组的比是字符串的要多用一个<code>cJSON_GetArrayItem</code>函数，其他的没区别。<br><strong>4. cJSON_Delete()</strong><br>用来释放你第一步获取的句柄，来释放整个内存。用在解析完后调用</p>
<h2 id="读一层配置文件"><a href="#读一层配置文件" class="headerlink" title="读一层配置文件"></a>读一层配置文件</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;spidev1&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;device_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;spidev1&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;speed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;150000&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;mode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;bits&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;8&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;delay&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;spidev3&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;device_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;spidev3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;speed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;160000&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;mode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;bits&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;8&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;delay&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;spidev4&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;device_name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;spidev4&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;speed&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;130000&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;mode&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;0&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;bits&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;8&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;delay&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;10&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;cJSON.h&quot;</span></span><br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    FILE *fp = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;test.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">fread</span>(buf, <span class="hljs-number">1</span>, <span class="hljs-built_in">sizeof</span>(buf), fp);<br>    cJSON *root = <span class="hljs-built_in">cJSON_Parse</span>(buf);<br><br>    cJSON *subobj = <span class="hljs-built_in">cJSON_GetObjectItem</span>(root, <span class="hljs-string">&quot;spidev2&quot;</span>);<br>    <span class="hljs-keyword">if</span> (subobj)<br>    &#123;<br>        cJSON *item = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj, <span class="hljs-string">&quot;speed&quot;</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;speed: %d\n&quot;</span>, (<span class="hljs-type">int</span>)<span class="hljs-built_in">atoi</span>(item-&gt;valuestring));<br><br>        item = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj, <span class="hljs-string">&quot;mode&quot;</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;mode: %d\n&quot;</span>, (<span class="hljs-type">int</span>)<span class="hljs-built_in">atoi</span>(item-&gt;valuestring));<br><br>        item = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj, <span class="hljs-string">&quot;bits&quot;</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;bits: %d\n&quot;</span>, (<span class="hljs-type">int</span>)<span class="hljs-built_in">atoi</span>(item-&gt;valuestring));<br><br>        item = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj, <span class="hljs-string">&quot;delay&quot;</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;delay: %d\n&quot;</span>, (<span class="hljs-type">int</span>)<span class="hljs-built_in">atoi</span>(item-&gt;valuestring));<br>        <br><br>        <span class="hljs-built_in">cJSON_Delete</span>(root);<br>        <span class="hljs-built_in">fclose</span>(fp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="读两层配置文件"><a href="#读两层配置文件" class="headerlink" title="读两层配置文件"></a>读两层配置文件</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><br>	<span class="hljs-attr">&quot;奔驰&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-punctuation">&#123;</span><br>		<span class="hljs-attr">&quot;factory&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-string">&quot;一汽大众&quot;</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;last&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-number">31</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;price&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-number">83</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;sell&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-number">49</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;sum&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-number">80</span><span class="hljs-punctuation">,</span><br>		<span class="hljs-attr">&quot;other&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-punctuation">[</span><span class="hljs-number">123</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;hello, world&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">&#123;</span><br>				<span class="hljs-attr">&quot;梅斯德斯奔驰&quot;</span><span class="hljs-punctuation">:</span>	<span class="hljs-string">&quot;心所向, 持以恒&quot;</span><br>			<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><br>	<span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;cJSON.h&quot;</span></span><br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    FILE* fp = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;car.json&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);<br>    <span class="hljs-type">char</span> buf[<span class="hljs-number">1024</span>] = &#123;<span class="hljs-number">0</span>&#125;;<br>    <span class="hljs-built_in">fread</span>(buf, <span class="hljs-number">1</span>, <span class="hljs-built_in">sizeof</span>(buf), fp);<br>    cJSON* root = <span class="hljs-built_in">cJSON_Parse</span>(buf);<br> <br>    cJSON* subobj = <span class="hljs-built_in">cJSON_GetObjectItem</span>(root,<span class="hljs-string">&quot;奔驰&quot;</span>);<br>    <span class="hljs-keyword">if</span>(subobj)&#123;<br>        <span class="hljs-comment">// 获取子对象</span><br>        cJSON* fasctory = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj,<span class="hljs-string">&quot;factory&quot;</span>);<br>        cJSON* last = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj,<span class="hljs-string">&quot;last&quot;</span>);<br>        cJSON* price = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj, <span class="hljs-string">&quot;price&quot;</span>);<br>        cJSON* sell = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj,<span class="hljs-string">&quot;sell&quot;</span>);<br>        cJSON* sum = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj,<span class="hljs-string">&quot;sum&quot;</span>);<br>        cJSON* other = <span class="hljs-built_in">cJSON_GetObjectItem</span>(subobj,<span class="hljs-string">&quot;other&quot;</span>);<br> <br>        <span class="hljs-comment">// 打印value的值</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;奔驰:  \n&quot;</span>);<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    factor:  %s\n&quot;</span>,<span class="hljs-built_in">cJSON_pRINT</span>(fasctory));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    last:  %s\n&quot;</span>,<span class="hljs-built_in">cJSON_pRINT</span>(last));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    price:  %s\n&quot;</span>,<span class="hljs-built_in">cJSON_pRINT</span>(price));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    sell:  %s\n&quot;</span>,<span class="hljs-built_in">cJSON_pRINT</span>(sell));<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    sum:  %s\n&quot;</span>,<span class="hljs-built_in">cJSON_pRINT</span>(sum));<br> <br>        <span class="hljs-comment">// 打印数组内容</span><br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;    other:\n&quot;</span>);<br>        <span class="hljs-keyword">if</span>(other-&gt;type == cJSON_Array)&#123;<br>            <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-built_in">cJSON_GetArraySize</span>(other);i++)&#123;<br>                cJSON* node = <span class="hljs-built_in">cJSON_GetArrayItem</span>(other,i);<br>                <span class="hljs-keyword">if</span>(node-&gt;type == cJSON_String)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;       %s  \n&quot;</span>,node-&gt;valuestring);<br>                &#125;<br>                <span class="hljs-keyword">if</span>(node-&gt;type == cJSON_Number)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;        %s  \n&quot;</span>,node-&gt;valueint);<br>                &#125;<br>                <span class="hljs-keyword">if</span>(node-&gt;type == cJSON_True)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;        %s  \n&quot;</span>,node-&gt;valueint);<br>                &#125;<br>                <span class="hljs-keyword">if</span>(node-&gt;type == cJSON_False)&#123;<br>                    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;        %s  \n&quot;</span>,node-&gt;valueint);<br>                &#125;<br>            &#125;<br>        &#125;<br>        <span class="hljs-built_in">cJSON_Delete</span>(root);<br>        <span class="hljs-built_in">fclose</span>(fp);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="写入两层文件"><a href="#写入两层文件" class="headerlink" title="写入两层文件"></a>写入两层文件</h2><p>效果如上节：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&quot;cJSON.h&quot;</span></span><br> <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-comment">// 创建对象</span><br>    cJSON* obj = <span class="hljs-built_in">cJSON_CreateObject</span>();<br>    <span class="hljs-comment">// 创建子对象</span><br>    cJSON* subObj = <span class="hljs-built_in">cJSON_CreateObject</span>();<br>    <span class="hljs-comment">// 添加key-value</span><br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj, <span class="hljs-string">&quot;factory&quot;</span>, <span class="hljs-built_in">cJSON_CreateString</span>(<span class="hljs-string">&quot;一汽大众&quot;</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj,<span class="hljs-string">&quot;last&quot;</span>,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">31</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj,<span class="hljs-string">&quot;price&quot;</span>,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">83</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj,<span class="hljs-string">&quot;sell&quot;</span>,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">49</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj,<span class="hljs-string">&quot;sum&quot;</span>,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">80</span>));<br>    <span class="hljs-comment">// 创建一个json数组</span><br>    cJSON* array = <span class="hljs-built_in">cJSON_CreateArray</span>();<br>    <span class="hljs-built_in">cJSON_AddItemToArray</span>(array,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">123</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToArray</span>(array,<span class="hljs-built_in">cJSON_CreateNumber</span>(<span class="hljs-number">1</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToArray</span>(array,<span class="hljs-built_in">cJSON_CreateString</span>(<span class="hljs-string">&quot;hello, world&quot;</span>));<br>    <span class="hljs-comment">// 数组中的对象</span><br>    cJSON* subsub= <span class="hljs-built_in">cJSON_CreateObject</span>();<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subsub,<span class="hljs-string">&quot;梅斯德斯奔驰&quot;</span>,<span class="hljs-built_in">cJSON_CreateString</span>(<span class="hljs-string">&quot;心所向, 持以恒&quot;</span>));<br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(subObj,<span class="hljs-string">&quot;other&quot;</span>,array);<br>    <span class="hljs-comment">// obj 中添加key_value</span><br>    <span class="hljs-built_in">cJSON_AddItemToObject</span>(obj,<span class="hljs-string">&quot;奔驰&quot;</span>, subObj);<br> <br>    <span class="hljs-comment">// 数据格式化</span><br>    <span class="hljs-type">char</span>* data = <span class="hljs-built_in">cJSON_Print</span>(obj);<br>    FILE *fp = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;car.json&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>);<br>    <span class="hljs-built_in">fwrite</span>(data,<span class="hljs-built_in">sizeof</span>(<span class="hljs-type">char</span>),<span class="hljs-built_in">strlen</span>(data)<span class="hljs-number">+1</span>,fp);<br>    <span class="hljs-built_in">fclose</span>(fp);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br> <br>&#125;<br></code></pre></td></tr></table></figure>


                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Language/" class="category-chain-item">Language</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/C-C/" class="print-no-link">#C/C++</a>
      
        <a href="/tags/Data-Structure/" class="print-no-link">#Data Structure</a>
      
    </div>
  
</div>


              

              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/06/16/SW/IoT/HuaweiYun-IoT/" title="华为云物联网设备接入及OBS使用">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">华为云物联网设备接入及OBS使用</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/06/06/SW/Interview/Data-Structure-HashMap/" title="哈希表">
                        <span class="hidden-mobile">哈希表</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  


  
  









    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Tech Odyssey</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>2024</span></a> 
    </div>
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  
      <script>
        if (!window.MathJax) {
          window.MathJax = {
            tex    : {
              inlineMath: { '[+]': [['$', '$']] }
            },
            loader : {
              load: ['ui/lazy']
            },
            options: {
              renderActions: {
                insertedScript: [200, () => {
                  document.querySelectorAll('mjx-container').forEach(node => {
                    let target = node.parentNode;
                    if (target.nodeName.toLowerCase() === 'li') {
                      target.parentNode.classList.add('has-jax');
                    }
                  });
                }, '', false]
              }
            }
          };
        } else {
          MathJax.startup.document.state(0);
          MathJax.texReset();
          MathJax.typeset();
          MathJax.typesetPromise();
        }

        Fluid.events.registerRefreshCallback(function() {
          if ('MathJax' in window && MathJax.startup.document && typeof MathJax.startup.document.state === 'function') {
            MathJax.startup.document.state(0);
            MathJax.texReset();
            MathJax.typeset();
            MathJax.typesetPromise();
          }
        });
      </script>
    

  <script  src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js" ></script>

  <script  src="/js/local-search.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
<!-- hexo injector body_end start --><script data-pjax src="https://unpkg.com/oh-my-live2d"></script><script>const oml2d = OML2D.loadOml2d({dockedPosition:"left",mobileDisplay:false,models:[{"path":"/live2d-models/models/umaru/model.json","position":[100,30],"scale":0.25,"stageStyle":{"width":400,"height":470}},{"path":"/live2d-models/models/kobayaxi/model.json","position":[30,0],"scale":0.3,"stageStyle":{"width":400}},{"path":"/live2d-models/models/bilibili-22/index.json","position":[0,30],"scale":0.35,"stageStyle":{"width":400}},{"path":"/live2d-models/models/bilibili-33/index.json","position":[0,30],"scale":0.35,"stageStyle":{"width":400}}],parentElement:document.body,primaryColor:"#7f6f6c",tips:{style: {"left":"calc(50%)","top":"-50px"},idleTips:{interval:150}}});</script><!-- hexo injector body_end end --></body>
</html>
